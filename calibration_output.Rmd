---
title: "Fourmile Calibrations"
author: "Megan Sears"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(plotly)

```

```{r load in files, include = F}

kge <- read_csv('calruns_KGE.csv')

params <- read_csv('calruns_params.csv') %>%
  drop_na()

```

# KGE

```{r look at kge, echo = F}

kge_plot <- ggplot(kge, aes(year_missing, KGE, shape = input_data, color = input_data)) + geom_point(size = 3) +
  theme_bw()

ggplotly(kge_plot)

```

# Parameters

```{r params, echo = F}

params <- params %>%
  mutate(input_data = case_when(
    grepl('station', run) ~ 'station',
    grepl('grid', run) ~ 'grid'
  )) %>%
  mutate(year_missing_almost = gsub('station_|grid_', '', run)) %>%
  mutate(year_missing = gsub('all', 'none', year_missing_almost)) %>%
  select(-c(year_missing_almost)) %>%
  filter(!param == 'locGrw',
         !param == 'tempRes') %>%
  mutate(value = as.numeric(value),
         param = as.factor(param))

plot_params <- function(param_name) {
  params %>%
    filter(param == param_name) %>%
    ggplot(aes(x = year_missing,
               y = value,
               shape = input_data, 
               color = input_data)) + 
    geom_point(size = 3) + 
    ggtitle(param_name) +
    theme_bw()
}

name <- levels(params$param)

lapply(name, plot_params)

write.csv(params, 'params.csv')

```

